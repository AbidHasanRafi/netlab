## GraphQL Subscriptions

GraphQL Subscriptions একটি বিশেষ ফিচার যা ক্লায়েন্ট-সার্ভার সম্পর্কের মধ্যে রিয়েল-টাইম ডেটা আপডেটের জন্য ব্যবহৃত হয়। এই ফিচারটি ব্যবহারকারীকে ডেটা পরিবর্তন বা আপডেটের জন্য অবহিত করার জন্য ব্যবহৃত হয়, যেমন একটি নিউজ ফিডে নতুন পোস্ট আসা বা একটি চ্যাট অ্যাপে নতুন মেসেজ আসা ইত্যাদি। এটি ক্লায়েন্টকে সার্ভারের সাথে সংযুক্ত রাখে এবং সার্ভার যখন কোনো পরিবর্তন ঘটায়, তখন সেই পরিবর্তন ক্লায়েন্টে রিয়েল-টাইমে পাঠানো হয়।

এই অধ্যায়ে আমরা বিস্তারিতভাবে জানব যে, GraphQL Subscriptions কী, কিভাবে এটি কাজ করে, এর সঠিক ব্যবহার এবং এর সুবিধাগুলি কী।


### ১. Subscriptions কী?

Subscriptions হল সেই GraphQL অপারেশন যা ক্লায়েন্টকে একটি নির্দিষ্ট ইভেন্টের জন্য সাবস্ক্রাইব করতে দেয়। এটি ক্লায়েন্টের জন্য একটি ইভেন্ট ভিত্তিক ডেটা স্ট্রিম তৈরি করে, যার মাধ্যমে ক্লায়েন্ট প্রতি পরিবর্তনের সাথে সাথে অবহিত হতে পারে। এটি ডেটা ফেচিং এবং মিউটেশন অপারেশন থেকে আলাদা কারণ এটি সাধারণত ক্লায়েন্টের ইন্টারঅ্যাকশনের বাইরে চলে গিয়ে ডেটা পরিবর্তন বা ইভেন্টে রিয়েল-টাইম আপডেট প্রদান করে।

যতক্ষণ না ক্লায়েন্ট সাবস্ক্রিপশন বন্ধ করে দেয়, ততক্ষণ পর্যন্ত সার্ভার ক্লায়েন্টকে রিয়েল-টাইম ডেটা প্রদান করতে থাকে। এটি ব্যবহৃত হয় যখন ডেটা পরিবর্তনের সাথে সাথে ক্লায়েন্টকে তা জানতে হবে, যেমন:
- লাইভ স্কোর দেখানো
- মেসেজিং সিস্টেমে নতুন মেসেজ আসা
- নিউজ ফিডের আপডেট হওয়া


### ২. Subscriptions এর সাথে Query এবং Mutation এর পার্থক্য

GraphQL এ সাধারণত তিনটি প্রধান অপারেশন ব্যবহৃত হয়: Query, Mutation, এবং Subscription।

- Query: এটি ডেটা রিড (পড়ার) অপারেশন। এর মাধ্যমে ডেটা সার্ভার থেকে ক্লায়েন্টে পাঠানো হয়।
- Mutation: এটি ডেটা রাইট (লেখার) অপারেশন। এর মাধ্যমে ক্লায়েন্ট ডেটা পরিবর্তন বা আপডেট করতে পারে।
- Subscription: এটি একটি বিশেষ ধরনের অপারেশন যা ক্লায়েন্টকে রিয়েল-টাইম ডেটা আপডেট প্রদান করে।

Query এবং Mutation একবারেই সম্পন্ন হয়, কিন্তু Subscription একটি দীর্ঘস্থায়ী সংযোগ বজায় রাখে। অর্থাৎ, Subscription একবার সাবস্ক্রাইব করা হলে, এটি সার্ভারের সাথে সংযুক্ত থাকে এবং যখনই কোনো পরিবর্তন ঘটে, তখন সেটি ক্লায়েন্টকে রিয়েল-টাইমে জানিয়ে দেয়।


### ৩. Subscriptions এর কার্যপ্রণালী

#### ১. ক্লায়েন্টের সাবস্ক্রিপশন শুরু করা
GraphQL Subscription-এর কাজ শুরু হয় যখন ক্লায়েন্ট সার্ভারের একটি সাবস্ক্রিপশন রিকোয়েস্ট পাঠায়। এই সাবস্ক্রিপশন রিকোয়েস্টটি সার্ভারের কাছে একটি রিয়েল-টাইম ডেটা স্ট্রিম খুলে দেয়। উদাহরণস্বরূপ, একটি চ্যাট অ্যাপ্লিকেশনে নতুন মেসেজের জন্য সাবস্ক্রাইব করতে হলে, ক্লায়েন্ট সার্ভারে রিকোয়েস্ট পাঠাবে:

```graphql
subscription {
  newMessage {
    user
    content
    timestamp
  }
}
```

এখানে:
- subscription হলো অপারেশন টাইপ যা সার্ভারকে বলছে যে, ক্লায়েন্ট নতুন মেসেজের জন্য সাবস্ক্রাইব করতে চাচ্ছে।
- newMessage হলো সাবস্ক্রিপশন ফিল্ড যা সার্ভার থেকে রিয়েল-টাইম মেসেজ আপডেট নিয়ে আসে।

#### ২. সার্ভার সাবস্ক্রিপশন ইভেন্ট ট্রিগার করা
যখনই সার্ভারের ডেটা কোনো পরিবর্তন হয়, যেমন নতুন মেসেজ আসা বা কোনো নোটিফিকেশন আসা, সার্ভার সেটি ক্লায়েন্টকে পাঠাতে শুরু করবে। সার্ভার নতুন মেসেজ আসলে তা ক্লায়েন্টের সাবস্ক্রিপশনে পাঠাবে:

```json
{
  "data": {
    "newMessage": {
      "user": "John",
      "content": "Hello, how are you?",
      "timestamp": "2025-03-10T12:00:00Z"
    }
  }
}
```

এটি তখন ক্লায়েন্টকে রিয়েল-টাইমে দেখাবে, যেমন একটি চ্যাট অ্যাপে নতুন মেসেজের জন্য পুশ নোটিফিকেশন বা নতুন মেসেজ শো করবে।

#### ৩. সাবস্ক্রিপশন বন্ধ করা
ক্লায়েন্ট যখন আর রিয়েল-টাইম ডেটা প্রাপ্তি চায় না, তখন সাবস্ক্রিপশন বন্ধ করা হয়। সাধারণত, ক্লায়েন্ট যখন পৃষ্ঠাটি বন্ধ করে বা নির্দিষ্ট সাবস্ক্রিপশন বন্ধ করার জন্য ক্লিক করে, তখন এটি সার্ভারের সাথে সংযোগ বিচ্ছিন্ন করে দেয়। এর ফলে সার্ভার আর রিয়েল-টাইম ডেটা পাঠায় না। 


### ৪. Subscriptions ব্যবহার করার সুবিধা

#### ১. রিয়েল-টাইম ডেটা
GraphQL Subscriptions ক্লায়েন্টকে সার্ভারের সাথে রিয়েল-টাইম ডেটা আপডেট প্রদান করার ক্ষমতা দেয়। এতে ক্লায়েন্টের পক্ষে গুরুত্বপূর্ণ ডেটা পরিবর্তন বা ইভেন্টের সঙ্গে দ্রুত সিঙ্ক্রোনাইজ থাকা সম্ভব হয়।

#### ২. ইন্টারঅ্যাকটিভ অ্যাপ্লিকেশন তৈরি
Subscriptions এর মাধ্যমে আপনি ইন্টারঅ্যাকটিভ অ্যাপ্লিকেশন তৈরি করতে পারবেন যা ব্যবহারকারীদের পরিবর্তন শিগগিরই দেখাবে। যেমন একটি লাইভ স্কোর বোর্ড, যেখানে খেলা চলাকালীন সময়ে পয়েন্ট আপডেট হবে এবং ব্যবহারকারী তা রিয়েল-টাইমে দেখতে পাবে।

#### ৩. ক্লায়েন্ট এবং সার্ভারের মধ্যে কম যোগাযোগ
একটি সাবস্ক্রিপশন খোলার মাধ্যমে সার্ভার এবং ক্লায়েন্টের মধ্যে একবার সংযোগ স্থাপন করা হয়। এরপর ক্লায়েন্ট সার্ভারে বারবার রিকোয়েস্ট পাঠানোর পরিবর্তে, সার্ভার নিজেই ক্লায়েন্টকে নতুন ডেটা পাঠাতে থাকে। এটি সার্ভারের উপরে চাপ কমায় এবং ক্লায়েন্টের জন্য একটি সাশ্রয়ী পদ্ধতি হয়ে ওঠে।

#### ৪. নতুন ইভেন্টের প্রতি ক্লায়েন্টের সচেতনতা
Subscriptions ব্যবহার করলে ক্লায়েন্ট অবিলম্বে সার্ভারের কাছে ঘটে যাওয়া পরিবর্তন সম্পর্কে জানতে পারে, যেমন নতুন মেসেজ আসা, নতুন ব্লগ পোস্ট হওয়া, অথবা নতুন রেটিং বা কমেন্ট আসা ইত্যাদি।


### ৫. Subscriptions সেট আপ করা

#### ১. Server-side Subscription setup
Server-side-এ, আপনাকে একটি রিয়েল-টাইম ডেটা স্ট্রিম তৈরি করতে হবে যা WebSockets বা অন্যান্য লাইভ ট্রান্সপোর্ট পদ্ধতি ব্যবহার করবে। সাধারণভাবে, `graphql-ws` অথবা `subscriptions-transport-ws` লাইব্রেরি ব্যবহার করা হয় সাবস্ক্রিপশন কনফিগারেশনের জন্য।

#### ২. Client-side Subscription setup
Client-side-এ আপনি একটি লাইব্রেরি ব্যবহার করতে পারেন, যেমন `Apollo Client` বা `Relay`। ক্লায়েন্টে, আপনাকে একটি Subscription link সেট করতে হবে যেটি সার্ভারের WebSocket connection ব্যবহার করবে।

#### ৩. WebSocket Connection
Subscriptions সাধারণত WebSockets ব্যবহার করে ক্লায়েন্ট এবং সার্ভারের মধ্যে স্থায়ী সংযোগ তৈরি করে। WebSocket সাপোর্ট করে দুটি দিকের যোগাযোগ, অর্থাৎ সার্ভার ক্লায়েন্টকে পুশ নোটিফিকেশন পাঠাতে পারে এবং ক্লায়েন্ট সার্ভারে রিকোয়েস্ট পাঠাতে পারে।


### ৬. Subscriptions এর চ্যালেঞ্জ এবং সমস্যা

#### ১. স্কেলিং সমস্যা
যেহেতু Subscriptions রিয়েল-টাইম ডেটা স্ট্রিম পরিচালনা করে, এটি বড় অ্যাপ্লিকেশনগুলোর জন্য স্কেলিং সমস্যা সৃষ্টি করতে পারে। একাধিক সংযোগের কারণে সার্ভারের ওপর চাপ পড়তে পারে এবং সেগুলো সঠিকভাবে পরিচালনা করা কঠিন হয়ে পড়তে পারে।

#### ২. নিরাপত্তা ইস্যু
রিয়েল-টাইম ডেটা আপডেটের জন্য WebSockets ব্যবহৃত হলে, নিরাপত্তা বিষয়ক কিছু সমস্যা হতে পারে। যেমন ডেটা এনক্রিপশন না থাকলে কোনো তৃতীয় পক্ষ ডেটা আটকিয়ে ফেলতে পারে। তাই, সাবস্ক্রিপশন ব্যবহারের সময় নিরাপত্তা নিশ্চিত করা প্রয়োজন।


GraphQL Subscriptions একটি অত্যন্ত শক্তিশালী এবং কার্যকরী পদ্ধতি যা ক্লায়েন্টকে রিয়েল-টাইম ডেটা আপডেট প্রদান করতে সাহায্য করে। এটি ডেটা পরিবর্তন বা ইভেন্টের সঠিক সময় জানিয়ে দেয়, যেমন নতুন মেসেজ, লাইভ স্কোর, বা অন্য যেকোনো রিয়েল-টাইম আপডেট। তবে, এর সাথে কিছু চ্যালেঞ্জ এবং স্কেলিং সমস্যা রয়েছে, যা যথাযথভাবে ম্যানেজ করা প্রয়োজন। 

এই ফিচারটি অ্যাপ্লিকেশনকে আরও ইন্টারঅ্যাকটিভ এবং ব্যবহারকারী-বান্ধব করতে সাহায্য করে, ফলে এটি আধুনিক ওয়েব ডেভেলপমেন্টে এক গুরুত্বপূর্ণ ভূমিকা পালন করে।